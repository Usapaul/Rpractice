---
title: "Задача на дисперсионный анализ"
author: "Usachev Pavel, 391"
date: '22 ноября 2016 г. '
output: html_document
lang: ru
---

### Введение и обработка данных

По условию задачи необходимо выяснить, влияет ли престижность района города на налог. При этом имея таблицу с данными о некоторых жителях города и размере налога, который они платят.

```{r, echo=TRUE} 
prestige <- read.table(file="Albuquerque.txt",header=T)
``` 

Из имеющейся таблицы данных следует исключить строки, которые содержат некорректное число в столбце "налог" ("TAX"), то есть число со знаком минус. Следует также исключить строки, где никаких данных о налоге нет, но таковых не было обнаружено после визуального просмотра таблицы. А также аргумент NE (престижный район/нет) будет сделан фактором.

```{r, echo=TRUE} 
prestige <- subset(prestige, TAX>0) 

prestige$TAX <- as.numeric(as.character(prestige$TAX)) 
prestige$NE <- as.character(as.numeric(prestige$NE)) 
prestige$NE <- factor(prestige$NE) 
``` 

Попробуем увидеть на столбчатой диаграмме очевидные выбросы, имеются ли они в нашей выборке размера налога. Столбчатая диаграмма используется из-за удобства просмотра. Жители, проживающие в престижном и обычном районах, представлены двумя разными цветами, а также имеет место сортировка по возрастанию значения налога. В легенде для диаграммы дополнительно указаны минимальное и максимальное значение налога.

```{r, echo=FALSE} 
ttax <- prestige[order(prestige$TAX),]
ttax$NE <- factor(ttax$NE)
ttax$color[ttax$NE==1] <- 3
ttax$color[ttax$NE==0] <- 1
barplot(ttax$TAX,col=ttax$color,ylim=c(0,max(ttax$TAX)),xlim=c(0,6),width=0.035, space=0.95)
legend("topleft",legend=c("N=1","N=0",paste("min =",min(ttax$TAX)), paste("max =",max(ttax$TAX))),fill=c(3,1,0,0))
``` 

Как видно на диаграмме, с учетом данных о минимальном и максимальном значениях, обе выборки не показывают очевидных выбросов.

### Проверка выборок на нормальность распределения

Для начала оценим оба распределения визуально. Для этого построим гисторамму для обеих выборок.

```{r, echo=FALSE}
hist(prestige$TAX[prestige$NE=="1"],col=5, breaks = 12)
hist(prestige$TAX[prestige$NE=="0"],col=7, breaks = 12)
``` 

Видно, что вторая гистограмма не дает веских оснований полагать, что распределение не нормальное. А первая -- для жителей престижного района -- не кажется описыващей действительно нормальное распределение. Тем не менее, выполним Шапиро-тест для убедительной оценки нормальности распределений.

```{r, echo=FALSE}
fligner.test(TAX ~ NE, prestige)
``` 

```{r, echo=TRUE}
shapiro.test(prestige$TAX[prestige$NE == "1"])
shapiro.test(prestige$TAX[prestige$NE == "0"])
``` 

Но при большом количестве наблюдений, как у нас, функция aov не требует нормальности распределений. Можно ее выполнить при исходных данных.


#aov

Наконец, выполним дисперсионный анализ при помощи функции aov 

```{r, echo=TRUE}
summary(aov(prestige$TAX ~ prestige$NE, data=prestige))
``` 

####После выполнения функции aov было получено значение Pr(>F) несколько меньшее 5%. По имеющемуся результату можно сделать вывод, что предложенные выборки размера налога для жителей престижного района и для жителей обычного района статистически различаются. Иными словами, нельзя утверждать, что престижность района не влияет на налог.


