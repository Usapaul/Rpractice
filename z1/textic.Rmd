---
title: "Отчет по задаче 6.3"
author: "Usachev Pavel, 391"
date: '15 ноября 2016 г. '
output: html_document
lang: ru
---

### Введение и обработка данных

По условию задачи необходимо сравнить туристов из Западной Европы и из Восточной Европы по среднему месячному доходу туристов. При этом имея таблицу с данными о некоторых туристах, представляющих оба интересующих класса. 
В первую очередь таблица была просмотрена вручную, и на местах, где данные отсутствуют, были вставлены символы "*". Теперь таблицу можно считать.

```{r, echo=TRUE} 
tourist <- read.csv(file = "tourists2.csv", header = T, sep=";")
``` 

Из всего предложенного списка туристов следует выбрать только тех, которые нас интересуют по условию задачи, а также необходимо исключить из рассмотрения тех туристов, по доходам которых нет данных (стоит символ "*" в графе доходов). И преобразуем типы данных в таблице для работы с ними.

```{r, echo=TRUE} 
tourist <- subset(tourist, USD!="*") 
tourist <- subset(tourist, Region!="3") 
``` 

```{r, echo=FALSE} 
is.character(tourist$USD) 
tourist$USD <- as.numeric(as.character(tourist$USD)) 
tourist$Region <- as.character(as.numeric(tourist$Region)) 
tourist$Region <- factor(tourist$Region) 
``` 

Попробуем увидеть на столбчатой диаграмме очевидные выбросы, имеются ли они в нашей выборке доходов туристов. Столбчатая диаграмма используется из-за удобства просмотра. Туристы, представляющие два разных класса, представлены двумя разными цветами, а также имеет место сортировка по возрастанию доходов туристов.

```{r, echo=FALSE} 
moneytour <- tourist[order(tourist$USD),]
moneytour$Region <- factor(moneytour$Region)
moneytour$color[moneytour$Region==1] <- 8
moneytour$color[moneytour$Region==2] <- 4
barplot(sort(tourist$USD),col=moneytour$color,legend.text = c(1,2),ylim=c(0,86000))
``` 

Как видно на столбчатой диаграмме, никакие из значений доходов туристов не похожи на "выбросы". 

### Проверка выборок на нормальность распределения

Для начала стоит построить график распределений и буквально посмотреть на него, чтобы оценить нормальность.

Подключение пакета ggplot2 и построение графика.
```{r, echo=FALSE} 
library("ggplot2", lib.loc="E:/R-3.3.1/library") 
ggplot(tourist, aes(USD, fill = Region))+ 
  geom_density(alpha=0.5)  
``` 

Также существенно необходимо выполнить проверку на нормальность Шапиро-тестом.

```{r, echo=FALSE} 
by(tourist$USD, INDICES = tourist$Region, shapiro.test) 
```

Тест указывает на значительное отличие одного из распределений от нормального. Применяем возведение в степень, равную -1, и снова проверяем распределения на нормальность Шапиро-тестом.

```{r, echo=FALSE} 
by((tourist$USD)^(-1), INDICES = tourist$Region, shapiro.test) 
```

Операция возведения в степень оказалась существенно полезной, и теперь Шапиро-тест выдает p-value>0.05 для обеих выборок. Посмотрим на графики распределений после операции возведения в степень для визуальной их оценки.

```{r, echo=FALSE} 
touristext <- tourist 
touristext$USD <- (tourist$USD)^(-1) 
ggplot(touristext, aes(USD, fill = Region))+ 
  geom_density(alpha=0.5) 
```

После выполнения Шапиро-теста с преобразованными выборками следует выполнить также проверку на равенство дисперсий при помощи Fligner-test.

```{r, echo=FALSE} 
fligner.test(USD ~ Region, touristext) 
```

### t-test

Убедившись в нормальности распределений и гомогенности их дисперсий, можно применить тест Стьюдента для преобразованных выборок.

```{r, echo=TRUE} 
t.test(USD ~ Region, touristext)
```
Стоит отметить, что t-test выдает значение p-value очень близкое к 5%. А при другом способе преобразования данных (логарифмирование вместо возведения в степень, другой показатель степени) t-test выдает значение p-value меньше 0.05, но также очень близкое к 0,05. Это граничный случай для принятия нулевой гипотезы при данном 5%-ном уровне значимости.

####t-test выдает значение p-value>0.05. Исходя из этого, можно сделать вывод, что туристы из двух рассматриваемых регионов статистически значимо не отличаются по уровню среднемесячных доходов.

